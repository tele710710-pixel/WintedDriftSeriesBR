<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ† Ğ¤Ğ¡Ğ‘ Black Russia</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>*{margin:0;padding:0;box-sizing:border-box;}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#1e3c72 0%,#2a5298 100%);color:#fff;min-height:100vh;padding:20px;}.container{max-width:500px;margin:0 auto;}.header{text-align:center;margin-bottom:30px;padding:25px;background:rgba(255,255,255,0.1);border-radius:20px;backdrop-filter:blur(10px);}.tabs{display:flex;justify-content:center;gap:10px;margin-bottom:25px;flex-wrap:wrap;}.tab{padding:12px 24px;border-radius:25px;background:rgba(255,255,255,0.2);cursor:pointer;transition:all 0.3s;font-weight:500;}.tab.active{background:linear-gradient(45deg,#00d4ff,#0099cc);box-shadow:0 8px 25px rgba(0,212,255,0.4);}.section{background:rgba(255,255,255,0.1);border-radius:20px;padding:25px;margin-bottom:20px;backdrop-filter:blur(15px);display:none;}.section.active{display:block;}.section h3{margin-bottom:20px;font-size:1.4em;}.table{width:100%;border-collapse:collapse;}.table th,.table td{padding:15px 10px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.2);}.table th{font-weight:600;color:#00d4ff;text-transform:uppercase;font-size:0.85em;}.medal{font-size:1.3em;font-weight:bold;}.player-card{background:rgba(0,212,255,0.2);border-radius:15px;padding:20px;margin-bottom:15px;border:1px solid rgba(255,255,255,0.2);}.player-nick{font-size:1.3em;font-weight:bold;margin-bottom:10px;}.player-info{font-size:0.95em;opacity:0.9;}.refresh-btn{width:100%;background:linear-gradient(45deg,#00d4ff,#0099cc);color:#fff;border:none;padding:18px;border-radius:25px;font-size:18px;font-weight:600;cursor:pointer;margin-top:20px;transition:all 0.3s;}.refresh-btn:hover{transform:translateY(-3px);box-shadow:0 15px 35px rgba(0,212,255,0.5);}.empty{text-align:center;color:#aaa;font-style:italic;padding:50px 20px;}</style>
</head>
<body>
<div class="container">
    <div class="header"><h1>ğŸ† Ğ¤Ğ¡Ğ‘ Black Russia</h1><p>Ğ¢ÑƒÑ€Ğ½Ğ¸Ñ€Ğ½Ñ‹Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ â€¢ 2 ÑÑ‚Ğ°Ğ¿Ğ°</p></div>
    <div class="tabs">
        <div class="tab active" data-tab="total">ğŸ† Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ñ‡Ñ‘Ñ‚</div>
        <div class="tab" data-tab="stage1">ğŸ“ˆ Ğ­Ñ‚Ğ°Ğ¿ 1</div>
        <div class="tab" data-tab="stage2">ğŸ“ˆ Ğ­Ñ‚Ğ°Ğ¿ 2</div>
        <div class="tab" data-tab="players">ğŸ‘¥ Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¸</div>
    </div>
    <div id="total" class="section active"><h3>ğŸ† Ğ˜Ğ¢ĞĞ“ĞĞ’Ğ«Ğ™ Ğ—ĞĞ§ĞĞ¢</h3><table class="table"><thead><tr><th>ĞœĞµÑÑ‚Ğ¾</th><th>Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸Ğº</th><th>ĞÑ‡ĞºĞ¸</th></tr></thead><tbody id="total-table"></tbody></table></div>
    <div id="stage1" class="section"><h3>ğŸ“ˆ Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« Ğ­Ğ¢ĞĞŸĞ 1</h3><table class="table"><thead><tr><th>ĞœĞµÑÑ‚Ğ¾</th><th>Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸Ğº</th><th>ĞÑ‡ĞºĞ¸</th></tr></thead><tbody id="stage1-table"></tbody></table></div>
    <div id="stage2" class="section"><h3>ğŸ“ˆ Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ« Ğ­Ğ¢ĞĞŸĞ 2</h3><table class="table"><thead><tr><th>ĞœĞµÑÑ‚Ğ¾</th><th>Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸Ğº</th><th>ĞÑ‡ĞºĞ¸</th></tr></thead><tbody id="stage2-table"></tbody></table></div>
    <div id="players" class="section"><h3>ğŸ‘¥ Ğ’ÑĞµ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¸</h3><div id="players-list"></div></div>
    <button class="refresh-btn" onclick="loadData()">ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ</button>
</div>
<script>
Telegram.WebApp.ready();Telegram.WebApp.expand();
// âŒ Ğ£Ğ‘Ğ ĞĞĞ MainButton ÑĞ½Ğ¸Ğ·Ñƒ!
// Telegram.WebApp.MainButton.setText("ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ").show().onClick(loadData);

document.querySelectorAll('.tab').forEach(tab=>{
    tab.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
        document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
        loadData();
    });
});

async function loadData(){
    try{
        // ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ ÑĞ¿Ğ¸Ğ½Ğ½ĞµÑ€ Ğ² Ñ‚Ğ°Ğ±Ğµ (Ğ±ĞµĞ· MainButton)
        document.querySelector('.refresh-btn').innerHTML = 'â³ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°...';
        const response = await fetch('data.json');
        const data = await response.json();
        updateTable('total-table',data.total||{});
        updateTable('stage1-table',data.stages?.stage1||{});
        updateTable('stage2-table',data.stages?.stage2||{});
        updatePlayersList(data.players||{});
        document.querySelector('.refresh-btn').innerHTML = 'ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ';
        Telegram.WebApp.HapticFeedback.impactOccurred('light');
    }catch(e){
        console.error('ĞÑˆĞ¸Ğ±ĞºĞ°:',e);
        document.querySelector('.refresh-btn').innerHTML = 'âŒ ĞÑˆĞ¸Ğ±ĞºĞ°! ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹ ĞµÑ‰Ñ‘ Ñ€Ğ°Ğ·';
        setTimeout(()=>document.querySelector('.refresh-btn').innerHTML = 'ğŸ”„ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ', 2000);
    }
}

function updateTable(tableId,data){
    const tbody=document.getElementById(tableId);
    tbody.innerHTML=Object.keys(data).length?
        Object.entries(data).sort(([,a],[,b])=>b-a).slice(0,15).map(([nick,points],i)=>
            `<tr><td><span class="medal">${i<3?'ğŸ¥‡ğŸ¥ˆğŸ¥‰'[i]:i+1+'.'}</span></td><td><strong>${nick}</strong></td><td><strong>${points}</strong></td></tr>`
        ).join(''):'<tr><td colspan="3" class="empty">ĞĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…</td></tr>';
}

function updatePlayersList(players){
    document.getElementById('players-list').innerHTML=Object.keys(players).length?
        Object.entries(players).map(([nick,info])=>
            `<div class="player-card">
                <div class="player-nick">${nick}</div>
                <div class="player-info">
                    <div>ğŸ–ï¸ Ğ Ğ°Ğ½Ğ³: <strong>${info.rank||'-'}</strong></div>
                    <div>ğŸ’³ Ğ¡Ñ‡Ñ‘Ñ‚: <strong>${info.account||'-'}</strong></div>
                    <div>ğŸš— ĞĞ²Ñ‚Ğ¾: <strong>${info.car||'-'}</strong></div>
                    <div>ğŸ“Š Ğ­Ñ‚Ğ°Ğ¿ 1: ${info.stage1||0} | Ğ­Ñ‚Ğ°Ğ¿ 2: ${info.stage2||0} | Ğ˜Ñ‚Ğ¾Ğ³: <strong>${info.total||0}</strong></div>
                </div>
            </div>`
        ).join(''):'<div class="empty">Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¸ Ğ½Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ñ‹</div>';
}

setInterval(loadData,30000);
loadData();
</script>
</body>
</html>
